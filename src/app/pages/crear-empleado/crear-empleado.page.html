<ion-header [translucent]="true">
  <ion-toolbar style="--background: #001E87; --color: white;">
    <ion-buttons slot="start">
      <ion-button fill="clear" (click)="volver()">
        <ion-icon name="arrow-back-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>{{ esEdicion ? 'Editar Empleado' : 'Crear Empleado' }}</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="crear-empleado-content">
  <div class="form-container">
    <!-- Formulario -->
    <div class="form-section">
      <!-- Nombre del empleado -->
      <div class="input-group">
        <ion-label class="input-label">Nombre Empleado</ion-label>
        <ion-input
          type="text"
          placeholder="Ingrese el nombre del Empleado"
          [(ngModel)]="empleado.nombre"
          class="custom-input">
        </ion-input>
      </div>

      <!-- Número de teléfono - SOLO NÚMEROS -->
      <div class="input-group">
  <ion-label class="input-label">Número Teléfono:</ion-label>
  <ion-input
    type="text"
    inputmode="numeric"
    placeholder="Ingrese el número de teléfono del Empleado"
    [(ngModel)]="empleado.telefono"
    (ionInput)="validarSoloNumeros($event)"
    class="custom-input">
  </ion-input>
</div>

      <!-- C.I. Empleado -->
      <div class="input-group">
        <ion-label class="input-label">C.I. Empleado</ion-label>
        <ion-input
          type="text"
          placeholder="Ingrese el documento del Empleado"
          [(ngModel)]="empleado.ci"
          class="custom-input">
        </ion-input>
      </div>

      <!-- Dirección Empleado -->
      <div class="input-group">
        <ion-label class="input-label">Dirección Empleado</ion-label>
        <ion-input
          type="text"
          placeholder="Ingrese la dirección del Empleado"
          [(ngModel)]="empleado.direccion"
          class="custom-input">
        </ion-input>
      </div>

      <!-- Usuario -->
      <div class="input-group">
        <ion-label class="input-label">Usuario</ion-label>
        <ion-input
          type="text"
          placeholder="Ingrese el usuario del Empleado"
          [(ngModel)]="empleado.usuario"
          class="custom-input">
        </ion-input>
      </div>

      <!-- Contraseña CON BOTÓN MOSTRAR/OCULTAR -->
      <div class="input-group">
  <ion-label class="input-label">Contraseña</ion-label>
  <div class="password-wrapper">
    <ion-input
      [type]="mostrarContrasena ? 'text' : 'password'"
      placeholder="Ingrese la contraseña del Empleado"
      [(ngModel)]="empleado.contrasena"
      class="custom-input">
    </ion-input>
    <ion-button
      fill="clear"
      class="eye-button"
      (click)="toggleMostrarContrasena()">
      <ion-icon
        [name]="mostrarContrasena ? 'eye-off-outline' : 'eye-outline'"
        slot="icon-only">
      </ion-icon>
    </ion-button>
  </div>
</div>

      <!-- Rol - ACTUALIZADO CON MODAL -->
      <div class="input-group">
        <ion-label class="input-label">Rol</ion-label>
        <ion-button
          expand="block"
          fill="outline"
          class="select-rol-button"
          (click)="abrirModalRoles()">
          <ion-icon name="shield-checkmark-outline" slot="start"></ion-icon>
          <span class="rol-seleccionado">{{ rolSeleccionadoNombre || 'Seleccione el Rol del empleado' }}</span>
          <ion-icon name="chevron-down-outline" slot="end"></ion-icon>
        </ion-button>
      </div>
    </div>

    <!-- Botón guardar -->
    <div class="guardar-container">
      <ion-button
        expand="block"
        class="guardar-button"
        (click)="guardarEmpleado()"
        [disabled]="loading">
        <ion-spinner name="crescent" *ngIf="loading"></ion-spinner>
        {{ loading ? 'Guardando...' : (esEdicion ? 'Actualizar Empleado' : 'Guardar Empleado') }}
      </ion-button>
    </div>
  </div>
</ion-content>

<!-- Modal de Roles -->
<ion-modal #modalRoles [isOpen]="modalRolesAbierto" (didDismiss)="cerrarModalRoles()">
  <ng-template>
    <ion-header>
      <ion-toolbar style="--background: #001E87; --color: white;">
        <ion-title>Seleccionar Rol</ion-title>
        <ion-buttons slot="end">
          <ion-button (click)="cerrarModalRoles()">
            <ion-icon name="close"></ion-icon>
          </ion-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-header>

    <ion-content>
      <!-- Lista de roles -->
      <ion-list>
        <ion-item
          *ngFor="let rol of roles"
          button
          (click)="seleccionarRol(rol)"
          [class.selected-item]="empleado.rol === rol.value">
          <ion-icon name="shield-checkmark" slot="start" color="primary"></ion-icon>
          <ion-label>
            <h2>{{ rol.label }}</h2>
          </ion-label>
          <ion-icon
            *ngIf="empleado.rol === rol.value"
            name="checkmark-circle"
            slot="end"
            color="primary">
          </ion-icon>
        </ion-item>
      </ion-list>
    </ion-content>
  </ng-template>
</ion-modal>